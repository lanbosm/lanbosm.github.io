webpackJsonp([8],{"/pee":function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=a("Dd8w"),s=a.n(e),r=a("9r5n"),n=a("EfEM"),l=a.n(n),c=a("n6Px"),o=a("NYxO"),d={name:"detail",data:function(){return{loadState:0,title:"详情",tabbarIndex:1,productDetail:{},id:null,quantity:1,favorited:!1,activeScroll:[],scrollY:0,headerGlass:!1,keepHeader:0,minTransalteY:0,press:!1}},created:function(){this.id=this.$route.params.id,this.fetchData()},computed:s()({},Object(o.c)("cart",["totalPushs"])),mounted:function(){},watch:{tabbarIndex:function(t){var i=this,a=this.$refs["scroll"+t],e=!1;this.activeScroll.forEach(function(t){t.target===a&&(e=!0)}),e||this.$nextTick(function(t){console.log("添加"),i.activeScroll.push(i.initScroll(a))})}},methods:s()({},Object(o.b)("cart",["cartPush"]),{swipeTabStart:function(t,i){this.press=!1},swipeTabMove:function(t,i){if(t.preventDefault(),1==this.loadState){if(!("X"===t.swipeAxis))return!1;var a=this.getRect(i).width,e=this.getRect(i).left,s=this.getRect(this.$refs.slideLine).left;this.getRect(this.$refs.scrollUl).width;e+=1*t.deltaX,s-=.3*t.deltaX,e>0?e-=.8*t.deltaX:Math.abs(e)>.8*a&&(e-=.8*t.deltaX),s<52?s+=.3*t.deltaX:Math.abs(s)>302&&(s+=.3*t.deltaX),this.$animate.setCSS(i,{transform:"translate("+e+"px,0px)"}),this.$animate.setCSS(this.$refs.slideLine,{transform:"translate("+s+"px,0px)"}),t.distanceX<-30&&!this.press?(this.press=!0,this.tabbarIndex++,this.tabbarIndex=this.tabbarIndex<3?this.tabbarIndex:3):t.distanceX>30&&!this.press&&(this.press=!0,this.tabbarIndex--,this.tabbarIndex=this.tabbarIndex<1?1:this.tabbarIndex)}},swipeTabEnd:function(t,i){t.preventDefault(),1===this.loadState&&(this.press=!1,this.switchTab())},switchTab:function(t){var i=this.getRect(this.$refs.scrollUl).width/3,a=i/3,e=a/2-this.getRect(this.$refs.slideLine).width/2;t&&(this.tabbarIndex=t),3===this.tabbarIndex?(this.$animate.bufferTransition(this.$refs.scrollUl,{transform:"translate(-"+2*i+"px,0px)"}),this.$animate.bufferTransition(this.$refs.slideLine,{transform:"translate("+(2*a+e)+"px,0px)"})):2===this.tabbarIndex?(this.$animate.bufferTransition(this.$refs.scrollUl,{transform:"translate(-"+i+"px,0px)"}),this.$animate.bufferTransition(this.$refs.slideLine,{transform:"translate("+(1*a+e)+"px,0px)"})):(this.$animate.bufferTransition(this.$refs.scrollUl,{transform:"translate(0px,0px)"}),this.$animate.bufferTransition(this.$refs.slideLine,{transform:"translate("+(0*a+e)+"px,0px)"}))},getMin:function(t){var i=-1*this.getRect(t).height+this.getRect(this.$refs.scrollUl).height;return i>0&&(i=0),i},initScroll:function(t){t=t;var i=this,a=this.$refs.banner,e=this.$refs.tabbar,s=this.keepHeader||this.getRect(e).top-this.getRect(this.$refs.header.$el).height;this.keepHeader=s;var r=this.minTransalteY||this.getRect(a).height-this.getRect(e).top;this.minTransalteY=r;var n=this.getRect(this.$refs.banner).height;return Object(c.a)(t,!0),Object(c.a)(a,!0),Object(c.a)(e,!0),new l.a({touch:t.parentNode,vertical:!0,target:t,property:"translateY",sensitivity:1,factor:1,min:this.getMin(t),bindSelf:!1,maxSpeed:2,initialValue:this.scrollY,max:0,touchMove:function(t,i){null!=this.y2&&this.y2<=0&&i<=this.min&&this.to(this.min)},change:function(l){l<-s?(i.headerGlass=!0,a.firstChild.style.webkitFilter="blur(4px)"):(i.headerGlass=!1,a.firstChild.style.webkitFilter="none");var c=Math.max(-s,l);i.scrollY=c;var o=1,d=Math.abs(l/n);o=l>0?1+d:1,a.scaleY=a.scaleX=c>r?o-r/n:1,e.translateY=c,a.translateY=c<0?c:0,i.activeScroll.forEach(function(a,e){a.target!==t&&(a.target.translateY=i.scrollY)})},animationEnd:function(t){}})},fetchData:function(){var t=this;this.$store.dispatch("getDetail",this.id).then(function(i){t.productDetail=i.data.productDetail,t.loadState=1,t.$nextTick(function(i){t.activeScroll.push(t.initScroll(t.$refs.scroll1))})}).catch(function(i){console.log(i),t.loadState=2,4040===i.code?t.$toast("不存在该商品"):t.$toast(r.d)})},addCart:function(){this.cartPush({id:this.productDetail.id,cid:this.productDetail.cid,pingpai:this.productDetail.pingpai,name:this.productDetail.name,spec:"史诗皮肤",price:this.productDetail.price,quantity:1,image:this.productDetail.url}),this.$toast({message:"添加成功",position:"bottom",duration:1e3})},toFavorite:function(){var t="关注成功";this.favorited?(t="取消成功",this.favorited=!1):this.favorited=!0,this.$toast({message:t,position:"bottom",duration:1e3})},buyNow:function(){var t=this;this.$indicator.open({text:r.g,spinnerType:"fading-circle"}),this.$store.dispatch("order/singleBuy",{id:this.id,quantity:this.quantity}).then(function(i){t.$indicator.close(),t.$router.push("/orderDetail/"+t.id)}).catch(function(i){t.$indicator.close(),t.handleError(i)})}})},h={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"page full flex flex-col detail"},[a("my-header",{ref:"header",staticClass:"container-header",class:{animated:1==t.loadState,glass:t.headerGlass},attrs:{title:t.title}},[a("div",{attrs:{slot:"right"},slot:"right"},[t._v("分享")])]),t._v(" "),1==t.loadState?a("div",{staticClass:"container-main",attrs:{id:"wrapper1"}},[a("ul",{directives:[{name:"finger",rawName:"v-finger:swipe",value:{events:{touchStart:t.swipeTabStart,touchMove:t.swipeTabMove,touchEnd:t.swipeTabEnd}},expression:"{ events:{touchStart:swipeTabStart,touchMove:swipeTabMove,touchEnd:swipeTabEnd}}",arg:"swipe"}],ref:"scrollUl",class:"container-tab-ul container-tab-show"+t.tabbarIndex},[a("div",{staticClass:"container-tab container-tab-1"},[a("div",{ref:"scroll1",staticClass:"scroll-list"},[a("div",{staticClass:"item-info"},[a("div",{staticClass:"item-info-list"},[a("div",{staticClass:"item-info-list-row title"},[t._v("\n                英雄名称 "),a("span",[t._v(t._s(t.productDetail.name))])]),t._v(" "),a("div",{staticClass:"item-info-list-row flex flew-row"},[a("span",{staticClass:"field price"},[t._v("价格 "+t._s(t._f("currency")(t.productDetail.price)))]),t._v(" "),a("span",{staticClass:"field stock"},[t._v("库存 "+t._s(t.productDetail.stock))])]),t._v(" "),a("div",{staticClass:"item-info-list-row"},[t._v("\n                定位： "),t._l(t.productDetail.role,function(i){return a("span",{key:i,staticClass:"tag"},[t._v(t._s(i))])})],2),t._v(" "),t._l(t.productDetail.rd,function(i){return t.productDetail.detailPicList?a("div",{key:i,staticClass:"item-info-list-row"},[t._v("\n                 "+t._s(t.productDetail.desc)+"\n              ")]):t._e()})],2)])])]),t._v(" "),a("div",{ref:"scrollTab2",staticClass:"container-tab container-tab-2"},[a("div",{ref:"scroll2",staticClass:"scroll-list"},[a("div",{staticClass:"item-pic"},[a("ul",t._l(t.productDetail.detailPicList,function(i){return a("li",{key:i.id},[a("p",[t._v(t._s(t.productDetail.desc))]),t._v(" "),a("img",{staticClass:"img-responsive",attrs:{src:i}})])}))])])]),t._v(" "),a("div",{staticClass:"container-tab container-tab-3"},[t.productDetail.evaluates?a("div",{ref:"scroll3",staticClass:"scroll-list"},[a("div",{staticClass:"item-evaluate"},t._l(t.productDetail.evaluates,function(i,e){return a("mt-cell",{key:e,attrs:{title:i.memo}},[t._v("\n                "+t._s(i.star)+"\n              ")])}))]):a("data-loading")],1)]),t._v(" "),a("div",{ref:"banner",staticClass:"item-banner"},[a("img",{staticClass:"img-responsive",attrs:{src:t.productDetail.banner}})]),t._v(" "),a("div",{ref:"tabbar",staticClass:"container-tab-head"},[a("div",{staticClass:"detail-tabbar-item",class:{active:1==t.tabbarIndex},on:{click:function(i){t.switchTab(1)}}},[t._v("\n        商品\n      ")]),t._v(" "),a("div",{staticClass:"detail-tabbar-item",class:{active:2==t.tabbarIndex},on:{click:function(i){t.switchTab(2)}}},[t._v("\n        详情\n      ")]),t._v(" "),a("div",{staticClass:"detail-tabbar-item",class:{active:3==t.tabbarIndex},on:{click:function(i){t.switchTab(3)}}},[t._v("\n        评价\n      ")]),t._v(" "),a("div",{staticClass:"detail-tabbar-line",class:"line"+t.tabbarIndex},[a("div",{ref:"slideLine",staticClass:"slide-line"})])])]):0==t.loadState?a("data-loading"):a("data-error",{attrs:{message:"阿狸酱加载不了呜"}},[a("mt-button",{on:{click:t.fetchData}},[t._v("再试一次")])],1),t._v(" "),a("div",{staticClass:"detail-footer flex flex-row"},[a("div",{staticClass:"detail-footer-item favorite"},[a("i",{staticClass:"iconfont icon-xing",class:[t.favorited?"hasfavorite":"unfavorite"],on:{click:function(i){t.toFavorite()}}}),t._v(" "),a("span",{staticClass:"footer-txt"},[t._v("关注")])]),t._v(" "),a("div",{staticClass:"detail-footer-item cart",class:{active:t.totalPushs>0},on:{click:function(i){t.pagePush("/cart")}}},[a("i",{staticClass:"iconfont icon-gouwuche"}),t._v(" "),a("span",{staticClass:"footer-txt"},[t._v("购物车("+t._s(t.totalPushs)+")")])]),t._v(" "),a("div",{staticClass:"detail-footer-item addCart",on:{click:function(i){t.addCart()}}},[a("span",{staticClass:"footer-txt"},[t._v("加入购物车")])]),t._v(" "),a("div",{staticClass:"detail-footer-item buyNow",on:{click:function(i){t.buyNow()}}},[a("span",{staticClass:"footer-txt"},[t._v("立即购买")])])])],1)},staticRenderFns:[]};var f=a("VU/8")(d,h,!1,function(t){a("z5Ya")},"data-v-f63ce77a",null);i.default=f.exports},z5Ya:function(t,i){}});